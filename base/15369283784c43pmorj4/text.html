<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я не понимаю язык Си++. Да, я два десятилетия программирую на этом языке, но для меня он и по сей день остается загадкой. Даже если отбросить в сторону все сложности поддерживаемых языком парадигм и структур, то окажется, что язык этот не становится более понятным. Это происходит из-за того, что сложен не только весь язык как таковой, в нем сложна такая простая и детерминированная вещь как синтаксис.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я часто смотрю на код в чужих проектах и говорю себе: &quot;Твою ж мать, что тут написано?&quot;. Причем, проблемы не только в понимании структуры чужой программы, проблемы возникают при понимании даже одной строчки кода.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Говорят, что писать программы надо с использованием языка, а не на языке. Многие Си++ программисты этого либо не знают, либо не могут себе такой роскоши позволить. Они вязнут в низкоуровневых подробностях, и за собой способны утянуть и других разработчиков и всю структуру проекта. Вместо борьбы со сложностью, чем по своей сути и является программирование, получается игра в &quot;догадайся, что это&quot;. Поначалу игра может быть и увлекательной, но быстро начинает утомлять.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Здесь я собираю практические рекомендации о том, как ориентироваться в синтаксисе языка Си++. Надеюсь, это поможет начинающим разработчикам не бросить попытки понимания языка и его возможностей. А матерым разработчикам позволит взглянуть на язык с другой стороны, и, может быть, упорядочить и освежить свои представления о нем.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все что здесь написано - сугубо личное видение синтаксиса языка Си++. Здесь могут быть существенные фактологические и логические ошибки, происходящие по одной банальной причине - автор сего текста не знает и не понимает язык Си++, и с трудом продирается сквозь его синтаксис.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; font-weight:600;">Контекстная зависимость</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Почему синтаксис языка Си++ такой сложный? Потому что в нем во главу угла поставлена великая и ужасная Контекстная Зависимость. Что это такое? Говоря простыми словами, это когда один и тот же символ или оператор означает совершенно разные вещи в зависимости от того, в каком месте команды он находится.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поэтому получается, что недостаточно знать операторы языка. В первую очередь надо научиться понимать контекст, в котором применен оператор, и только потом уже разбираться с тем, что оператор на самом деле делает.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Хорошая новость заключается в том, что контекстов на самом деле немного. Плохая новость заключается в том, что выражения в языке Си++ можно построить так заковыристо, что понять контекст будет сложно. И, конечно, обычное дело, когда в одной команде языка Си++ для одного и того же оператора в разных частях команды действуют разные контексты.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Далее перечислены контексты, которые наиболее часто встречаются в коде Си++:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Контекст в зависимости от типа переменной</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Контекст при определении переменной</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Контекст в выражении</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Контекст при определении функции (метода)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Контекст при манипуляциях с областью видимости</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Это контексты, полученные просто из практических соображений. Можно вычленить и другие контексты, но для упрощения изложения стоит оставиться на них, и при необходимости дополнить данный список.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; font-weight:600;">Выражение, инструкция, присваивание</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Начать понимать синтаксис языка Си++ лучше всего с того, чтобы уложить в голове две базовые вещи, используемые в языке:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выражение</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Инструкция</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы их различать, можно дать такие определения:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; font-style:italic;">Выражение</span><span style=" font-style:italic;"> - это то, что выдает (в результате своего вычисления) некое значение.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Инструкция - это </span><span style=" font-weight:600; font-style:italic;">выражение</span><span style=" font-style:italic;"> (зачастую, составное), завершенное точкой с запятой.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выражения, почти всегда, являются составными выражениями. Почему так? Просто потому, что любое имя переменной, константанта или литерал - это уже выражение. Если выражения объединяются оператором, то это тоже выражение, только составное.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, есть у нас две переменных: <span style=" font-family:'FreeMono'; color:#6a1009;">x</span> и <span style=" font-family:'FreeMono'; color:#6a1009;">y</span>. Уже одно только написание имени переменной <span style=" font-family:'FreeMono'; color:#6a1009;">x</span> будет выдавать значение переменной <span style=" font-family:'FreeMono'; color:#6a1009;">x</span>. Аналогично и для переменной <span style=" font-family:'FreeMono'; color:#6a1009;">y</span>. А написание имен переменных, объединенных оператором суммы будет выдавать значение суммы: <span style=" font-family:'FreeMono'; color:#6a1009;">x + y</span>. В этом и заключается работа с выражениями.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сложность возникает тогда, когда появляется <span style=" font-style:italic;">присваивание</span>. Ведь результат вычисления выражения надо чему-то присвоить. Особенностью языка Си++ является то, что присваивание в языке Си++ - это выражение.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другими словами, когда написано <span style=" font-family:'FreeMono'; color:#6a1009;">a = b + c</span> , то происходит две вещи:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В переменную <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> кладется значение суммы <span style=" font-family:'FreeMono'; color:#6a1009;">b + c</span>;</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Результатом выражения присваивания становится значение присваиваемого выражения.</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сложно? На самом деле все просто. На конкретных цифрах это будет выглядеть так: имеем <span style=" font-family:'FreeMono'; color:#6a1009;">b = 7</span> и <span style=" font-family:'FreeMono'; color:#6a1009;">c = 3</span>. Тогда значение переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> станет 10. Но и результатом вычисления всего выражения <span style=" font-family:'FreeMono'; color:#6a1009;">a = b + c</span> тоже будет число 10. Для лучшего понимания можно все заключить в круглые скобочки и сказать, что результатом выражения <span style=" font-family:'FreeMono'; color:#6a1009;">(a = b + c)</span> является число 10.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">И именно поэтому в языке СИ++ появляются такие странные инструкции присваивания:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">a = b = x + y;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для понимания того, что эта инструкция делает, надо в первую очередь понять используемый в ней контекст. Ясно, что в этой инструкции написано выражение, в котором происходит присваивание, а значит нам надо рассматривать выражение с контекстом присваивания. <span style=" font-style:italic;">Особенностью контекста присваивания в языке Си++ является то, что присваивание выполняется справа-налево.</span> То есть, сначала вычисляется то, что находится справа, и присваивается тому, что находится слева. Действительно: чтобы задать более левые значения, надо вначале вычислить правые. Поэтому последовательность действий с точки зрения языка можно написать так:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вычисляется выражение <span style=" font-family:'FreeMono'; color:#6a1009;">x + y</span>. Потому что оно самое правое.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вычисляется выражение <span style=" font-family:'FreeMono'; color:#6a1009;">b = x + y</span>. При вычислении этого выражения переменной <span style=" font-family:'FreeMono'; color:#6a1009;">b</span> будет присвоена сумма <span style=" font-family:'FreeMono'; color:#6a1009;">x + y</span>, а значение всего выражения <span style=" font-family:'FreeMono'; color:#6a1009;">b = x + y</span> будет эта же сумма.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> присваивается значение выражения <span style=" font-family:'FreeMono'; color:#6a1009;">b = x + y</span>.</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Здесь есть один тонкий момент. Я <span style=" text-decoration: underline;">думаю</span>, что переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> присваивается значение выражения <span style=" font-family:'FreeMono'; color:#6a1009;">b = x + y</span>. Возможно, правильно было бы сказать, что переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> присваивается значение выражения <span style=" font-family:'FreeMono'; color:#6a1009;">b</span>. Согласитесь, выражения <span style=" font-family:'FreeMono'; color:#6a1009;">b</span> и <span style=" font-family:'FreeMono'; color:#6a1009;">b = x + y</span> - это все-таки разные выражения, хотя их значения в данном случае одинаковые. Какое же из этих утверждений правильное? Здесь можно рассуждать следующим образом:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы разбираем данное выражение итеративно, рассматривая блоки операторов присваивания справа-налево. При этом мы должны все время оперировать термином &quot;выражение&quot;, и не перепрыгивать на термин &quot;значение (результат) выражения&quot;. То, что в момент разбора выражения происходит присвоение значений переменным, роли не играет. Таким образом, правильнее будет утверждать, что переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> присваивается значение выражения <span style=" font-family:'FreeMono'; color:#6a1009;">b = x + y</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кстати, в более простых языках, например в таком как Pascal, присваивание является инструкцией, а не выражением. То есть, при выполнении присваивания в Pascal, происходит вычисление только выражения в правой части. А разультата всей конструкции присваивания просто нет как понятия. Поэтому в Паскале нет такой возможности, как множественное присваивание. А если в каких-то диалектах оно и появится, то только в виде синтаксического сахара.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Завершая тему присваивания, можно показать еще один &quot;странный&quot; пример. Поскольку присваивание - это выражение, то его можно использовать в качестве аргумента функции:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">n = function( a = b );</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Значение выражения <span style=" font-family:'FreeMono'; color:#6a1009;">a = b</span> равно тому, что присваивалось, то есть значению <span style=" font-family:'FreeMono'; color:#6a1009;">b</span>. Поэтому в функцию передастся значение <span style=" font-family:'FreeMono'; color:#6a1009;">b</span>. Здесь возникает вопрос: а равно ли значение переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> значению <span style=" font-family:'FreeMono'; color:#6a1009;">b</span> в момент выполнения функции? Правильный ответ: да, равно. <span style=" font-style:italic;">Нетрудно запомнить, что при вычислении выражения с оператором присвоения =, присвоение происходит сразу при вычислении выражения.</span> Перед тем, как передаться в функцию, выражение должно быть вычислено. Именно при этом вычислении переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> присвоится значение <span style=" font-family:'FreeMono'; color:#6a1009;">b</span>. И только потом будет вызвана функция.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Но тут нужно помнить, что если использовать в выражении операторы постинкремента, например <span style=" font-family:'FreeMono'; color:#6a1009;">a = b++</span>, то значение такого выражения будет неизменнённое значение <span style=" font-family:'FreeMono'; color:#6a1009;">b</span> (т.е. значение до инкремента). Функция выполнится, и только после этого значение <span style=" font-family:'FreeMono'; color:#6a1009;">b</span> увеличится на <span style=" font-family:'FreeMono'; color:#6a1009;">1</span>. А значение <span style=" font-family:'FreeMono'; color:#6a1009;">a</span> все время останется прежним, неувеличенным значением <span style=" font-family:'FreeMono'; color:#6a1009;">b</span>. Подробнее можно прочитать здесь: <a href="mytetra://note/151143036362lvy3clsh"><span style=" text-decoration: underline; color:#0000ff;">Понимание преинкремента и постинкремента в языке C++</span></a>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Надо ли в своем коде использовать конструкции, подобные <span style=" font-family:'FreeMono'; color:#6a1009;">n = function( a = b )</span> ? Мое мнение: нет, не надо. Да, с такой конструкцией код становится несколько короче, но эта краткость идет в ущерб пониманию и читабельности. Гораздо правильнее с точки зрения дальнейшей поддержки исходного кода написать инструкции так, как они будут последовательно выполняться во времени при выполнении вышеозначенного кода. То есть, вот так:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">a = b;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">n = function( a );</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выглядит такая запись, по сравнению с предыдущим вариантом, не круто, а прямолинейно и наивно. Но понять ее не составляет никакого труда. Кроме того, современные оптимизирующие компиляторы для обоих вариантов генерируют одинаковый код.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; font-weight:600;">Определение указателей и ссылок</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы ориентироваться в этих самых звездочках <span style=" font-family:'FreeMono'; color:#6a1009;">*</span> и амперсандах <span style=" font-family:'FreeMono'; color:#6a1009;">&amp;</span>, надо, опять таки, понимать, в каких контекстах происходит их использование.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот пример ниже:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">int a=0;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">int &amp;b=a;  // Здесь b - ссылка на a</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">int *c=&amp;a; // Здесь c - указатель на a</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сначала надо разобраться со <span style=" font-weight:600;">строкой 2</span>. Наверняка многие знают, что <span style=" font-family:'FreeMono'; color:#6a1009;">&amp;</span> - это операция взятия адреса. Тогда почему вторая строка - это создание ссылки на <span style=" font-family:'FreeMono'; color:#6a1009;">a</span>? И при чем тут адрес?</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дело в том, что здесь надо понять в каком контексте происходит использование амперсанда &amp;. Для упрощения, вначале надо рассмотреть короткую форму выражения, то есть, только часть определения, без инициализации. (Пока за скобками оставим тот факт, что ссылка в C++ обязательно должна быть проинициализирована, иначе будет ошибка). Другими словами, надо откинуть часть, начиная с символа равно &quot;=&quot;, чтобы узнать, какая часть является определением. А символы после знака равно (включая знак равно, чтобы было более понятно) - явлются инициализацией.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Определение: int &amp;b</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Инициализация: =a</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так вот, назначение амперсанда <span style=" font-family:'FreeMono'; color:#6a1009;">&amp;</span> в контексте определения - говорить компилятору о том, что происходит определение ссылки. А операция взятия адреса тут вообще ни при чем.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оставшаяся часть выражения - <span style=" font-family:'FreeMono'; color:#6a1009;">=a</span> - это инициализация. Ссылка с именем <span style=" font-family:'FreeMono'; color:#6a1009;">b</span> связывается с переменной <span style=" font-family:'FreeMono'; color:#6a1009;">a</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь надо понять, что происходит в <span style=" font-weight:600;">строке 3</span>. Надо разбить строку на определение (до знака равно) и инициализацию:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Определение: int *c</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Инициализация: =&amp;a</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Звездочка <span style=" font-family:'FreeMono'; color:#6a1009;">*</span> в контексте определения говорит о том, что определяется указатель. (А не о том, что происходит операция с уродским названием &quot;разыменовывание&quot;).</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">А амперсанд &amp; в контексте инициализации говорит о том, что происходит операция взятия адреса. Вообще, контекст инициализации фактически эквивалентен контексту любого вычиляемого выражения C++. Потому что инициализация, по факту, и происходит каким-либо выражением. Знак амперсанда &amp; в контексте инициализации, также как и в контексте любого вычисляемого выражения, обозначает взятие адреса.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дописать...</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>