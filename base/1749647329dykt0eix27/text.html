<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">networkmanager</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install network-manager <br />systemctl status NetworkManager <br />nmcli device status состояние интерфейсов <br />nmcli general status <br />nmcli connection show список доступных подключений (ethernet, vpn и WiFi-сетей) <br />nmcli device wifi list список доступных Wi-Fi-сетей <br />nmcli connection show &quot;Проводное соединение 2&quot; информация о сети <br />nmcli connection up &quot;Проводное соединение 2&quot; подключиться <br />nmcli conn down &quot;Проводное соединение 2&quot; отключиться <br />nmcli radio wifi состояние Wi-Fi <br />nmcli connection add con-name &quot;dhcp&quot; type ethernet ifname ens33 создать подключение, передать тип устройства ethernet (Проводное соединение) и ifname, название сетевого интерфейса <br />nmcli conn modify &quot;dhcp&quot; ipv4.dns 8.8.8.8 настройки подключения (modify) <br />nmcli radio wifi on включить или выключить (off) Wi-Fi <br />nmcli device wifi connect &quot;TP-Link&quot; password 12345678 name &quot;TP-Link Wifi&quot; подключиться к Wi-Fi сети <br />nmcli networking off отключить сеть через (если управление через Network Manager, указывается в блоке конфигурации renderer для netplan) <br />nmcli networking on включить сеть <br />systemctl restart NetworkManager</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">wireless</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install wireless-tools <br />iwconfig <br />apt install iw <br />iw list <br />apt install wavemon <br />wavemon отобразить качество соединения и мощность передатчика</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">networking</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nano /etc/network/interfaces</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">auto ens33 активировать интерфейс при загрузке <br />iface ens33 inet static статический <br />address 192.168.1.50/24 <br />#netmask 255.255.255.0 <br />gateway 192.168.1.254 <br />dns-nameservers 8.8.8.8 1.1.1.1</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">auto ens33 <br />iface ens33 inet dhcp динамический</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">service networking restart перезагрузка сети <br />systemctl restart networking.service</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">ip</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">ip a ip addr show <br />ip -s link вывести ститстику всех сетевых интерфейсов <br />ip -br a show вывести только название интерфейса, статус работы и ip-адрес <br />ip link set dev ens33 up включить сетевой интерфейс <br />ip link set dev ens33 down выключить сетевой интерфейс <br />ip link set mtu 1550 dev ens33 изменить mtu <br />ip link set dev ens33 address AA:BB:CC:DD:EE:FF изменить mac-адрес (предварительно нужно отключить интерфейс, работает до перезагрузки) <br />ip addr add 192.168.3.106/24 broadcast 192.168.3.255 dev ens33 добавить адрес <br />ip addr del 192.168.3.106/24 dev ens33 удалить адрес <br />ip route show отобразить таблицу маршрутизации <br />ip route add 192.168.4.0 via 192.168.3.100 добавить маршрут <br />ip route del 192.168.4.0 via 192.168.3.100 удалить маршрут <br />ip route add 192.168.4.0 dev ens33 указать сетевой интерфейс, через который отправлять пакеты в определенную подсеть <br />ip neigh show отобразить ARP-таблицу <br />ip neigh add 192.168.3.110 lladdr b0:be:76:43:21:41 dev ens33 <br />ip neigh del dev end33 192.168.3.110 <br />ip neigh flush очистить ARP-таблицу</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">net-tools</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">ifconfig ens33 up/down <br />ifdown -a выключить все сетевые интерфейсы (пропадут из списка ifconfig) и включить (ifup -a) <br />ifconfig ens33 192.168.3.106 netmask 255.255.255.0 broadcast 192.168.3.255 <br />ifconfig -s || netstat -i список сетевых интерфейсов <br />netstat -atu ALL (-a) tcp (-t) и udp (-u) <br />netstat -lntup LISTEN (-l) dont resolve names (-n) и сканирует директорию /proc для вывода PID/Program name (-p) <br />arp -a таблица сопоставления ip и mac адресов <br />route -e отобразить таблицу маршрутизации <br />route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100 добавить маршрут в подсеть 192.168.4.0 через шлюз 192.168.3.100 <br />route del -net 192.168.4.0 netmask 255.255.255.0 удалить маршрут</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">networkd</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">systemctl status systemd-networkd <br />networkctl list список всех адаптеров, тип и состояния <br />networkctl status статус службы, Address и Gateway адаптера, DNS-адреса и лог systemd-networkd <br />networkctl status ens33 характеристики адаптера (Network File, Driver, Vendor, Model, MTU, Speed)</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">ss</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">ss -a All отобразить все сокеты <br />ss -l показать только прослушиваемые сокеты (LISTEN) <br />ss -t отобразить только установленные TCP соединения (ESTAB/ESTABLISHED) <br />ss -ua отобразить все открытые UDP сокеты <br />ss -da DHCP сокеты <br />ss -x отобразить только локальные UNIX соединения <br />ss -r Resolve, определять сетевые имена адресов с помощью DNS <br />ss -p Processes, показать процессы, использующие сокет <br />ss -n Numeric не определять имена служб (отображать только номер порта в числовом формате) <br />ss -ltp | grep 8080 <br />ss -tna | grep 22</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">dns</span></h2>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">resolv</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">cat /etc/resolv.conf | grep nameserver <br />nano /etc/resolv.conf работает до перезагрузки <br />domain domain.local <br />search domain.local <br />nameserver 8.8.8.8 <br />nameserver 1.1.1.1</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">resolved</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">networkctl status отображает список всех настроенные DNS-серверов в системе через netplan (или другое) для всех адаптеров <br />resolvectl status в systemd 239 (ubuntu 22.04) systemd-resolve переименован в resolvectl, выводит настроенные сервера для global и список все адресов для конкретного сетевого интерфейса Link (ens33) <br />resolvectl status | grep &quot;Current DNS&quot; отображает текущие используемые DNS-сервер <br />systemd-resolve --status служба локального DNS сервера <br />resolvectl flush-caches &amp;&amp; systemd-resolve --flush-caches очистить локальный кэш DNS <br />journalctl -u systemd-resolved | grep -E &quot;IN A|IN PTR|IN AAAA|IN PTR|IN MX&quot; логи кэша DNS <br />systemctl status systemd-resolved статус службы и его лог <br />cat /run/systemd/resolve/stub-resolv.conf файл-заглушка для демона systemd-resolved, по умолчанию nameserver 127.0.0.53, который перенаправляет обращения к локальному DNS серверу, а он, в свою очередь уже получает информацию от других серверов в интернете</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nano /etc/systemd/resolved.conf конфигурационный файл, отвечающий за настройку DNS-серверов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Включить кэширование:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">[Resolve]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">DNS=8.8.8.8, 192.168.3.101</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Cache=yes</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">ln -svi /run/systemd/resolve/resolv.conf /etc/resolv.conf создать симлинк для совместимости с приложениями, которые не используют библиотечные вызовы, а обращаются к DNS серверам напрямую, получая их из /etc/resolv.conf <br />ls -la /etc/resolv.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nano /etc/resolv.conf не управляется напрямую службой systemd-resolved, а иногда с помощью использования initscripts или NetworkManager, и любые пользовательские изменения могут быть изменены через время или после перезагрузки</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nameserver 8.8.8.8</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install resolvconf сервис для обновления списа адресов в /etc/resolv.conf (что бы он не перезаписывался) <br />systemctl status resolvconf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nano /etc/resolvconf/resolv.conf.d/head</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nameserver 8.8.8.8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nameserver 1.1.1.1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">dig</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">dig <br />dig google.com <br />dig @1.1.1.1 google.com a использовать DNS сервер Cloudflare для преобразования имени <br />dig @9.9.9.9 google.com mx использовать DNS сервер Quad9 для получения MX записи (A, NS, TXT) <br />dig -x 8.8.8.8 @9.9.9.9 разрешить ip в имя</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mtr</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">mtr google.com объединяет traceroute и ping каждого узла в трассеровке <br />mtr -I ens33 google.com указать интерфейс для проверки <br />mtr -b google.com отображать имя и ip <br />mtr --tcp google.com использовать TCP SYN-пакеты или UDP-дейтаграммы (--udp) <br />mtr -s 1000 google.com указать размер пакета <br />mtr -r -c 1 google.com --json указать кол-во ping пакетов (-c 1 и -i 2 изменить интервал) и вывести в виде отчета (--report) в формате json/xml/csv/raw</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">doggo</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">curl -sS https://raw.githubusercontent.com/mr-karan/doggo/main/install.sh | sh DNS cli client (</span><a href="https://github.com/mr-karan/doggo"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">https://github.com/mr-karan/doggo</span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) <br />doggo yandex.ru запросить домен, используя настройки по умолчанию <br />doggo yandex.ru MX запросить MX записи домена <br />doggo yandex.ru MX @8.8.8.8 использует указанный сервер для преобразования имен DNS <br />doggo -q yandex.ru -t MX --nameserver 1.1.1.1 <br />doggo yandex.ru --aa --ad запрос с установленными флагами авторитетного ответа и аутентифицированных данных <br />doggo yandex.ru --cd --do запрос с отключенной проверкой и установленными флагами DNSSEC OK <br />doggo yandex.ru --gp-from Germany Запрос с использованием API Globalping из указанной локации</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">vnstat</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install vnstat журнал часового, ежедневного и ежемесячного сетевого трафика <br />systemctl status vnstat проверить службу <br />vnstat -l мониторинг в реальном режиме <br />vnstat -h ежедневная почасовая история</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">netcat</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nc -zv 192.168.3.100 5985 проверить порт без попытки соединения (-z) в подробном режиме (-v) <br />nc -zvn 192.168.3.100 1-1000 сканирование tcp-портов, не используя преобразование DNS (-n) <br />nc -zvn 192.168.3.100 1-1000 2&gt;&amp;1 | grep succeeded перенаправить вывод ошибок в stdout и отфильтровать вывод <br />nc -zvnu 192.168.3.100 5550-5560 сканирование udp-портов (-u) <br />nc -lp 8081 открыть сокет (чат сервер) в режиме прослушивания (-listen) с указанием номера порта (-p) <br />nc 192.168.3.101 8081 подключиться к сокету (чат-клиент) <br />nc -lp 8081 &gt; out.txt все поступившие данные на сокет записываются в файл (вместо вывода в консоль) <br />cat /etc/passwd | nc -N 192.168.3.101 8081 передать содержимое файла на удаленный сокет принимающей стороны (содержимое /etc/passwd запишется в out.txt) и закрыть удаленный сокет (-N) <br />nc -l -w 1 -p 8081 задать timeout (-w) ожидания, в течении которого сервер слушает запрос, если будет 0, может не успеть считать запрос, на стороне клиента timeout должен быть не ниже <br />nc -w 5 -Uvl server.sock &gt; out.txt создать UNIX-сокет и передать вывод в файл, сокет закроется через 5 секунд (-w 5) или если будет задан параметр -N на стороне клиента <br />lsblk | nc -Uv server.sock подключиться к локальному сокету с второго терминала и отправить вывод команды в файл сокета приема <br />while true; do echo -e &quot;HTTP/1.1 200 OK\n\n$(systemd-analyze plot)&quot; | nc -l -w 1 -p 8085; done HTTP-сервер с выводом анализа загрузки системы</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">socket api</span></h3>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">port=8085</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">while true</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    request=$(nc -l -w 1 -p $port)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    request=$(echo &quot;$request&quot; | head -n 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    method=$(echo &quot;$request&quot; | cut -d &quot; &quot; -f 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    endpoint=$(echo &quot;$request&quot; | cut -d &quot; &quot; -f 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    if [[ $endpoint == &quot;/api/date&quot; ]]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">        then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">        response=&quot;HTTP/1.1 200 OK\nContent-Type: application/text\n\n$(date)&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    elif [[ $endpoint == &quot;/api/disk&quot; ]]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">        then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">        response=&quot;HTTP/1.1 200 OK\nContent-Type: application/json\n\n$(lsblk -e7 --json)&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">        response=&quot;HTTP/1.1 404 Not Found\n\n404 Not Found\n&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    fi</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">    echo -e &quot;$response&quot; | nc -l -w 1 -p $port</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">done</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">curl -s </span><a href="http://192.168.3.101:8085/api/date"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">http://192.168.3.101:8085/api/date</span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> <br />curl -s </span><a href="http://192.168.3.101:8085/api/disk"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">http://192.168.3.101:8085/api/disk</span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> | jq .blockdevices[]</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">socket proxy</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">ncat -l 8080 -k --sh-exec &quot;ncat 192.168.3.101 80&quot; <br />socat TCP-LISTEN:8080,fork,reuseaddr TCP:192.168.3.101:80</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">proxy</span></h2>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">sudo apt-get install -y dotnet-runtime-8.0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">arch=&quot;x64&quot; # или &quot;arm64&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">sudo curl -s -L &quot;https://github.com/Lifailon/froxy/releases/download/0.4.0/froxy-0.4.0-linux-$arch&quot; -o /usr/local/bin/froxy</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">sudo chmod +x /usr/local/bin/froxy</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">froxy --socks 1080 запустить SOCKS прокси на порту 1080 <br />froxy --forward 8080 запустить HTTP/HTTPS прокси на порту 1080 <br />froxy --forward 8080 &gt;&gt; froxy.log &amp; запустить фоновый процесс и передать вывод логов в файл <br />froxy --local 5514 --remote 192.168.3.100:514 запустить обратный прокси сервер на порту 5514, который перенаправляет на хост 192.168.3.100 и порт 514 (syslog) <br />froxy --local 192.168.3.100:2121 --remote 192.168.3.101:21 TCP туннелирование для RDP <br />froxy --local 127.0.0.1:8443 --remote https://example.com принимать HTTPS трафик на порту 8443 и переадресовать на указанный URL (поддерживаются GET и POST запросы с передачей заголовков и тела запроса от клиента, для использования API запросы и прохождения авторизации на сайтах) <br />froxy --local *:8443 --remote https://example.com --user admin --pass admin слушать на всех интерфейсах и использовать авторизацию</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">nmap</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nmap localhost узнать какие локальные порты прослушиваются <br />nmap -sV localhost определить какое какая ОС и ПО работает на портах и их версия <br />nmap -sL 192.168.3.0/24 список хостов с разрешением имен без пинга <br />nmap -sP 192.168.3.0/24 ping метод host discovery (TCP ACK SYN пакет, используя системныей вызов connect) с отображением производителя сетевой платы <br />nmap -F 192.168.3.0/24 fast mode port <br />nmap -A 192.168.3.100 подробное сканирование ОС и ПО (ssh на другом порту, version, ad sites, rdp-ntlm-info) <br />nmap -sA 192.168.3.100 обнаружить фильтрацию пакетов fw (filtered/unfiltered) с помощью TCP ACK <br />nmap -PN 192.168.3.100 сканировании защищенного хоста без ping <br />nmap -sO 192.168.3.100 определить какие именно IP-протоколы доступны и их статус, если отсутствует, значит фильтруется <br />nmap -PU 192.168.3.100 обойти межсетевой экран с помощью UDP-пинга <br />nmap -sS 192.168.3.100 выполнить полуоткрытое сканирование (TCP SYN) без установки подключения <br />nmap -sU 192.168.3.100 проверка только UDP-портов</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">masscan</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install masscan асинхронный (отправляет пакеты SYN) сканер TCP портов (</span><a href="https://github.com/robertdavidgraham/masscan"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">https://github.com/robertdavidgraham/masscan</span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) <br />masscan 192.168.3.100 -p80 <br />masscan 192.168.3.100 -p0-65535 --rate 100 <br />masscan 192.168.3.100 -p0-65535 --rate 100 --ping-timeout 1000 <br />masscan 192.168.3.1-100 -p80 <br />masscan 192.168.3.0/24 -p80,443 <br />masscan 192.168.3.100 -p80 --output-format json --output-file result.json</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">rustscan</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">wget https://github.com/RustScan/RustScan/releases/download/2.0.1/rustscan_2.0.1_amd64.deb \ snap install nmapтребуется установить пакет зависимости \apt-get install -fразрешить зависимости \dpkg --install rustscan_2.0.1_amd64.deb\rustscan -a 127.0.0.1\rustscan -a 192.168.3.100` 32400/tcp open plex</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">tcp</span></h3>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">function tcp-scan () {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  if [ &quot;$1&quot; == &quot;&quot; ]; then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">      exit 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  fi</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  START_PORT=$2; [ -z &quot;$START_PORT&quot; ] &amp;&amp; START_PORT=1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  END_PORT=$3; [ -z &quot;$END_PORT&quot; ] &amp;&amp; END_PORT=65535</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  PORT_PROTOCOL=&quot;tcp&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  scan_port(){</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">      PORT_NUMBER=$1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">      PORT_SCAN_RESULT=`2&gt;&amp;1 echo &quot;&quot; &gt; /dev/$PORT_PROTOCOL/$TARGET_NAME_OR_IP/$PORT_NUMBER | grep connect`</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">      [ &quot;$PORT_SCAN_RESULT&quot; == &quot;&quot; ] &amp;&amp; echo -e $PORT_NUMBER\/$PORT_PROTOCOL' \t 'open' \t\t '`grep $PORT_NUMBER/$PROTOCOL /etc/services | head -n1 | awk '{print $1}'`</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  TARGET_NAME_OR_IP=$1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  echo -e 'PORT \t\t STATE \t\t SERVICE'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  for PORT_NUMBER in `seq $START_PORT $END_PORT`; do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">      scan_port $PORT_NUMBER</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  done</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">}</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">tcp-scan 192.168.3.100 1024 5000</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">tcpdump</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">tcpdump -D список доступных сетевых интерфейсов <br />tcpdump -n -i ens33 icmp слушать icmp-пакеты от всех на указанном интерфейсе (-i) без отображения доменных имен (-n) <br />tcpdump -n -i ens33 udp -e слушать udp-пакеты и отображать MAC-адреса (-e) <br />tcpdump -n -i ens33 port 8080 слушать трафик 8080 порта <br />tcpdump -n -i ens33 port 80 or 443 <br />tcpdump -n -i ens33 portrange 21-80 <br />tcpdump -n -i ens33 ip src 192.168.3.99 and dst 192.168.3.103 отобразить ip пакеты, которые отправлены с указанного (src) ip-адреса на указанный (dst) ip-адрес <br />tcpdump -n -i ens33 -X host 192.168.3.100 and port 32400 отобразить содержимое пакетов (-X) для хоста и порта</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">tshark</span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install tshark <br />apt install termshark terminal UI for tshark (</span><a href="https://github.com/gcla/termshark"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">https://github.com/gcla/termshark</span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) <br />tshark -D список интерфейсов <br />tshark -i 1 <br />disown <br />tshark -i 1 -Y &quot;syslog&quot; захват пакетов syslog (udp.port == 514) <br />tshark -i 1 host 192.168.3.104 захват пакетов для конкретного IP-адреса <br />tshark -i 1 net 192.168.3.0/24 захват пакетов указанной подсети <br />tshark -i 1 src host 192.168.3.104 захват исходящих пакетов <br />tshark -i 1 dst host 192.168.3.104 захват входящих пакетов <br />tshark -i 1 dst host 192.168.3.104 and port 8086 отфильтровать по входящему хосту и порту <br />tshark -i 1 dst host 192.168.3.104 and port 8086 and src host 192.168.3.99 отфильтровать по исходящему хосту <br />tshark -i 1 -x dst host 192.168.3.104 and port 8086 and src host 192.168.3.101 прочитать пакеты в шестнадцатеричном формате (-x) <br />tshark -i 1 -O TCP dst host 192.168.3.104 and port 8086 and src host 192.168.3.101 прочитать TCP-заголовки <br />tshark -i 1 -a duration:10 -w ~/192.168.3.0.pcap сохранить захват <br />tshark -Y 'ip.addr == 192.168.3.106' -r ~/192.168.3.0.pcap прочитать файл захвата с использованием фильтра <br />tshark -Y &quot;(ip.addr == 192.168.3.106) or (ip.addr == 192.168.3.107)&quot; -r ~/192.168.3.0.pcap отфильтровать по двум адресам (или) <br />tshark -Y &quot;(ip.addr == 192.168.3.104) and (tcp.port == 8086)&quot; -r ~/192.168.3.0.pcap отфильтровать по двум параметрам (и) <br />tshark -Y &quot;!(ip.addr == 192.168.3.104)&quot; -r ~/192.168.3.0.pcap исключить <br />tshark -Y &quot;not arp and not (udp.port == 53)&quot; -r ~/192.168.3.0.pcap отобразить весь udp-трафик, исключив ping и dns пакеты</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">ping</span></h2>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">fping</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">fping yandex.ru google.com параллельная проверка доступности двух хостов <br />fping -p 5 yandex.ru google.com 5 параллельных запросов к каждому хосту <br />fping -ag 192.168.3.0/24 icmp проверка все подсети <br />fping &lt; hosts.txt произвести ping всех хостов указанных в файле с новой строки</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">netping</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">sudo curl -s https://raw.githubusercontent.com/Lifailon/net-tools/rsa/netping.sh -o /usr/bin/netping <br />sudo chmod +x /usr/bin/netping <br />netping 192.168.3.0</span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">firewall</span></h2>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">ufw</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">systemctl status ufw <br />ufw status <br />ufw enable включить ufw (Uncomplicated Firewall) <br />ufw disable отключить <br />ufw reload перезапустить/применить настройки <br />ufw reset сбросить настройки (отключить ufw и удалить все правила) <br />ufw default deny incoming все входящие пакеты отклонять (политика по умолчанию, какие действия будут применяться к пакетам, если они не подпадают под созданные правила) <br />ufw default allow outgoing все исходящие разрешать <br />ufw allow in 22 разрешить входящий трафик на порт 22 <br />ufw allow out 22 разрешить исходящий трафик на порт 22 <br />ufw deny in 80/tcp запретить входящий TCP-трафик на 80 порт <br />ufw delete deny in 80/tcp удалить правило <br />ufw allow 161,10050,10051/tcp открыть несколько портов <br />ufw allow proto tcp from 0.0.0.0/24 to 192.168.3.100 port 3389 разрешить доступ со всех IP-адресов по TCP-протоколу к IP-адресу и порту 3389 <br />ufw allow from 192.168.3.0/24 to 192.168.3.110 разрешить подключение всем с подсети 192.168.1.0 к интерфейсу 192.168.1.2 (для Proxmox MGW) <br />ufw allow 25/tcp открыть для всех направлений 25 порт <br />ufw limit ssh лимт подключений к определенному порту с одного IP-адреса (для защиты от перебора), по умолчанию подключения блокируются, если пользователь пытается создать шесть и больше подключений за 30 секунд (настроить время и количество запросов можно только через iptables) <br />ufw logging on включить логирование <br />ufw logging medium выбрать уровень логирования (low/medium/high) <br />cat /var/log/ufw директория хранения логов. Синтаксис: [UFW ALLOW/BLOCK/AUDIT] IN=интерфейс OUT=итерфейс SRC=ip_источника DST=ip_назначения LEN=размер_пакета TOS=0x10 PREC=0x00 TTL=64 ID=728 DF PROTO=протокол SPT=порт_источника DPT=порт назначения LEN=размер_пакета</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">show</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">ufw show listening отображает все прослушиваемые порты и правила для них (с указанием очередного номера в списке: [20] allow 161,10050,10051/tcp) <br />ufw show raw все активные правила в формате iptables <br />ufw show added недавно добавленные правила <br />ufw show builtins правила, добавленные по умолчанию <br />ufw show user-rules правила, добавленные пользователем <br />ufw show before-rules правила, которые выполняются перед принятием пакета <br />ufw show after-rules правила, которые выполняются после принятия пакета <br />ufw show logging-rules правила логгирования пакетов</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">firewalld</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">apt install firewalld <br />systemctl status firewalld <br />systemctl start firewalld <br />pkill -f firewalld убить процесс, если при запуске failed <br />firewall-cmd --state статус работы <br />firewall-cmd --reload применить настройки (перечитать) <br />firewall-cmd --list-all список созданных правил (для services и ports) <br />firewall-cmd --list-port только открытые порты <br />firewall-cmd --list-service только открытые службы <br />firewall-cmd --list-all-zones отобразить список зон <br />firewall-cmd --get-active-zones список используемых зон <br />firewall-cmd --list-all --zone=public информация о конкретной зоне <br />firewall-cmd --permanent --add-port=22/tcp открыть 22 порт <br />firewall-cmd --permanent --add-port=8000-8080/udp открыть диапазон портов <br />firewall-cmd --get-services | grep ssh отобразить список доступных служб <br />firewall-cmd --permanent --add-service=ssh разрешить порты для сервиса ssh <br />firewall-cmd --permanent --new-service=speedtest добавить службу <br />firewall-cmd --permanent --service=speedtest --add-port=80/tcp добавить порт к службе <br />firewall-cmd --info-service=speedtest информация о службе <br />firewall-cmd --permanent --add-rich-rule 'rule family=&quot;ipv4&quot; source address=&quot;192.168.3.0/24&quot; service name=&quot;speedtest&quot; accept' открыть доступ для подсети <br />firewall-cmd --permanent --add-rich-rule 'rule family=&quot;ipv4&quot; source address=&quot;192.168.3.0/24&quot; port port=&quot;22&quot; protocol=&quot;tcp&quot; accept' <br />firewall-cmd --permanent --add-rich-rule=&quot;rule family='ipv4' source address='192.168.21.0/24' reject&quot; закрыть доступ для подсети <br />firewall-cmd --list-rich-rules список правил с условиями <br />firewall-cmd --permanent --remove-port=22/tcp удалить правило</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">iptables</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">iptables -L -v выводит все существующие правила для каждой цепочки <br />iptables -L | grep -E &quot;tcp|udp&quot; <br />if (( $(iptables -L | wc -l | bc) == 8)); then echo active; else echo inactive; fi <br />iptables -A INPUT -p tcp --dport 22 -j ACCEPT открыть входящий порт ssh <br />iptables -A INPUT -p tcp -s !192.168.3.99 --dport 22 -j DROP закрыть входящий порт ssh, исключить 192.168.3.99 <br />iptables-save сохранить настройки, что бы они были активны после перезагрузки <br />iptables -F удалить все правила текущей таблицы</span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">nftables</span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">nft -a list ruleset список существующих правил <br />nft list tables список существующих таблиц <br />nft flush ruleset очистить правила <br />nft add table inet filter создать таблицу filter <br />nft add chain inet filter input { type filter hook input priority 0\; } добавить цепочку input <br />nft add rule inet filter input ct state related,established counter accept <br />nft add rule inet filter input iifname &quot;lo&quot; counter accept <br />nft add rule inet filter input ip protocol icmp counter accept разрешить icmp <br />nft add rule inet filter input tcp dport {80, 443} counter accept открыть порты <br />nft add rule inet filter input ip saddr { 192.168.100.0/24, 1.1.1.1/32 } tcp dport 22 counter accept открыть 22 порт для подсетей <br />nft chain inet filter input { policy drop \; } остальное блокировать <br />echo &quot;flush ruleset&quot; &gt; /etc/nftables.conf очистить все правила <br />nft -s list ruleset &gt;&gt; /etc/nftables.conf добавить правила в конфигурацию <br />systemctl enable nftables.service <br />nft delete rule inet filter input handle 5 удалить правило по номеру <br />nft add rule inet filter input position 5 tcp dport 22 counter accept добавить правило в конкретное место с номером в списке</span></p>
<h2 style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:x-large; font-weight:600;"><br /></h2></body></html>